<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Liora ‚Äî Espa√ßo de Estudo</title>
  <meta name="description" content="Liora √© um espa√ßo inteligente e tranquilo de estudo guiado, com temas personaliz√°veis e simulados interativos." />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc = "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";
  </script>
  <script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>
  <style>
    :root {
      --brand:#c44b04;
      --bg:#0b0b0b;
      --fg:#ffffff;
      --card:#151515;
      --muted:#bfbfbf;
      --stroke:#252525;
      --shadow:0 2px 8px rgba(0,0,0,0.4);
    }

    body.light {
      --brand:#f4a261;
      --bg:#faf7f2;
      --fg:#1e1e1e;
      --card:#ffffff;
      --muted:#6b6b6b;
      --stroke:#e0ddd8;
      --shadow:0 2px 10px rgba(0,0,0,0.1);
    }

    html, body {
      height:100%;
      transition: background-color 0.4s ease, color 0.4s ease;
    }

    body {
      background:var(--bg);
      color:var(--fg);
      font-family:'Inter', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", sans-serif;
      line-height:1.7;
      opacity:1;
      transition: opacity 0.4s ease, background-color 0.4s ease, color 0.4s ease;
    }

    body.fading { opacity:0; }

    .card {
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius:1rem;
      box-shadow:var(--shadow);
      transition:background-color 0.4s ease, box-shadow 0.4s ease, transform 0.3s ease;
    }
    .card:hover { transform:translateY(-2px); box-shadow:0 4px 16px rgba(0,0,0,0.5); }

    .btn {
      background:var(--brand);
      color:#fff;
      border-radius:16px;
      padding:.7rem 1rem;
      font-weight:600;
      transition:background 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
      box-shadow:0 0 6px rgba(196,75,4,0.4);
    }
    .btn:hover { background:#d75b0a; transform:translateY(-1px); box-shadow:0 0 10px rgba(196,75,4,0.6); }

    .chip {
      border:1px solid var(--stroke);
      border-radius:999px;
      padding:.35rem .7rem;
      color:var(--muted);
      transition:background 0.3s ease, color 0.3s ease;
      display:inline-flex; align-items:center; justify-content:center;
    }
    .chip:hover { background:var(--brand); color:#fff; }

    #btn-theme { font-size:1rem; cursor:pointer; transform:rotate(0deg); }
    #btn-theme.rotate { transform:rotate(180deg); }

    .dot {
      width:10px; height:10px; border-radius:50%;
      background:#10b981; display:inline-block; margin-left:.5rem;
    }

    .loading { display:inline-block; animation:spin 1s linear infinite; }
    @keyframes spin { from{transform:rotate(0)} to{transform:rotate(360deg)} }

    input {
      background:transparent;
      border:1px solid var(--stroke);
      border-radius:8px;
      padding:.5rem .75rem;
      width:100%;
      color:var(--fg);
      transition:border 0.3s ease, box-shadow 0.3s ease;
    }
    input:focus {
      border-color:var(--brand);
      box-shadow:0 0 0 2px rgba(196,75,4,0.3);
      outline:none;
    }

    .section-title { font-weight:600; color:var(--brand); }
    .session-card {
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius:1rem;
      padding:1rem;
      box-shadow:var(--shadow);
    }
  </style>
</head>

<body class="dark">
  <header class="max-w-5xl mx-auto px-4 pt-8">
    <div class="flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-2xl flex items-center justify-center text-white font-black" style="background:var(--brand)">Li</div>
        <div>
          <h1 class="text-xl font-bold">Liora ‚Äî Espa√ßo de Estudo <span class="dot" title="online"></span></h1>
          <p class="text-sm text-[var(--muted)]">Ambiente inteligente para aprender com foco.</p>
        </div>
      </div>
      <div class="flex items-center gap-2">
        <button id="btn-theme" class="chip" title="Alternar tema">üåô</button>
        <span class="chip">Sess√£o salva</span>
        <button id="btn-reset" class="chip" title="Limpar estado">Reset</button>
      </div>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-4 py-8 grid lg:grid-cols-3 gap-6">
    <section class="lg:col-span-1 card p-5">
      <h2 class="section-title mb-1">Configurar estudo</h2>
      <p class="text-sm text-[var(--muted)] mb-4">
        Escolha um tema ou envie seu material para gerar um plano personalizado de aprendizado.
      </p>

      <label class="block text-sm font-medium mb-1">Tema</label>
      <input id="inp-tema" type="text" placeholder="Ex.: IA Generativa, Hist√≥ria, Biologia" class="mb-3" />

      <div class="text-center my-2 text-xs text-[var(--muted)]">ou</div>

      <label class="block text-sm font-medium mb-1">Upload de material</label>
      <input id="inp-file" type="file" class="text-sm" />
      <p class="text-[11px] text-[var(--muted)] mt-2">
        Envie um arquivo <strong>TXT</strong>, <strong>PDF</strong> ou <strong>DOCX</strong> para gerar o plano.
      </p>

      <button id="btn-gerar" class="btn w-full mt-5">Gerar plano de estudo</button>
      <p id="status" class="text-xs text-[var(--muted)] mt-2"></p>
    </section>

    <section class="lg:col-span-2 card p-5">
      <div class="flex items-center justify-between mb-3">
        <h2 class="section-title">Seu plano de estudo</h2>
        <div class="text-sm text-[var(--muted)]" id="ctx"></div>
      </div>
      <div id="plano" class="space-y-3"></div>
    </section>
  </main>

  <footer class="max-w-5xl mx-auto px-4 pb-10 text-xs text-[var(--muted)] text-center">
    <p>Liora ‚Äî um ambiente de estudo guiado e inspirador. ¬© Intellih</p>
  </footer>

  <script>
    // ===== Tema =====
    const themeBtn = document.getElementById('btn-theme');
    const body = document.body;

    function setTheme(mode){
      body.classList.add('fading');
      themeBtn.classList.add('rotate');
      setTimeout(()=>{
        if(mode === 'light'){
          body.classList.add('light');
          localStorage.setItem('liora_theme','light');
          themeBtn.textContent = '‚òÄÔ∏è';
        } else {
          body.classList.remove('light');
          localStorage.setItem('liora_theme','dark');
          themeBtn.textContent = 'üåô';
        }
        setTimeout(()=> {
          body.classList.remove('fading');
          themeBtn.classList.remove('rotate');
        },200);
      },150);
    }

    themeBtn.addEventListener('click',()=>{
      const current = body.classList.contains('light') ? 'light' : 'dark';
      setTheme(current === 'light' ? 'dark' : 'light');
    });

    const savedTheme = localStorage.getItem('liora_theme');
    setTheme(savedTheme || 'dark');

    // ===== L√≥gica de arquivos =====
    const state = { tema:'', dias:5, materialTexto:'', plano:[] };

    const $ = id => document.getElementById(id);
    const els = {
      inpTema:$('inp-tema'),
      inpFile:$('inp-file'),
      btnGerar:$('btn-gerar'),
      status:$('status'),
      ctx:$('ctx'),
      plano:$('plano')
    };

    const setStatus = msg => els.status.innerHTML = msg;
    const updateCtx = () => els.ctx.textContent = `${state.materialTexto ? 'Material enviado' : (state.tema || 'Sem tema')} ¬∑ ${state.dias} sess√µes`;

    async function readFileContent(file){
      const ext = file.name.split('.').pop().toLowerCase();
      setStatus(`<span class='loading'>‚è≥</span> Processando arquivo...`);

      if(ext === 'txt'){
        return new Promise(res=>{
          const reader = new FileReader();
          reader.onload = ()=> res(reader.result.toString());
          reader.readAsText(file,'utf-8');
        });
      }

      if(ext === 'pdf'){
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await pdfjsLib.getDocument({data:arrayBuffer}).promise;
        let text = '';
        for(let i=1;i<=pdf.numPages;i++){
          const page = await pdf.getPage(i);
          const content = await page.getTextContent();
          text += content.items.map(it=>it.str).join(' ') + '\\n';
        }
        setStatus(`‚úÖ PDF lido com sucesso (${pdf.numPages} p√°ginas)`);
        return text;
      }

      if(ext === 'docx'){
        const arrayBuffer = await file.arrayBuffer();
        const result = await mammoth.extractRawText({arrayBuffer});
        setStatus(`‚úÖ Documento DOCX convertido.`);
        return result.value;
      }

      setStatus('‚ö†Ô∏è Formato n√£o suportado. Use TXT, PDF ou DOCX.');
      return '';
    }

    if(els.inpFile){
      els.inpFile.addEventListener('change', async (e)=>{
        const f = e.target.files?.[0]; if(!f) return;
        const text = await readFileContent(f);
        if(text){
          state.materialTexto = text;
          state.tema = state.tema || f.name.replace(/\\.(pdf|txt|docx?)$/i,'');
          updateCtx();
        }
      });
    }

    function extrairTopicos(texto, tema, n){
      let candidatos = [];
      if(texto){
        const linhas = texto.split(/\\n+/).map(s=>s.trim()).filter(Boolean);
        candidatos = linhas.filter(s=>s.split(' ').length<10).slice(0,60);
      }
      if(!candidatos.length){
        candidatos = [`Introdu√ß√£o ao tema ${tema}`, 'Conceitos principais', 'Aplica√ß√µes pr√°ticas', 'Revis√£o', 'S√≠ntese final'];
      }
      return candidatos.slice(0,n);
    }

    function descrever(topico, tema){
      return `Sess√£o sobre ${topico}, parte do tema ${tema}. Revisar conceitos e aplicar em exemplos.`;
    }

    function construirPlano(topicos,dias,tema){
      const plano=[];
      for(let i=0;i<dias;i++){
        const t=topicos[i%topicos.length];
        plano.push({dia:i+1,titulo:`Sess√£o ${i+1}`,topico:t,descricao:descrever(t,tema)});
      }
      return plano;
    }

    function renderPlano(){
      els.plano.innerHTML='';
      if(!state.plano.length){
        els.plano.innerHTML='<p class="text-sm text-[var(--muted)]">Crie um plano de estudo ao lado e ele aparecer√° aqui.</p>';
        return;
      }
      state.plano.forEach(p=>{
        const div=document.createElement('div');
        div.className='session-card';
        div.innerHTML=`<div class="text-sm font-semibold mb-1">${p.titulo}</div>
                       <div class="text-sm text-[var(--muted)] mb-1">${p.topico}</div>
                       <p class="text-sm">${p.descricao}</p>`;
        els.plano.appendChild(div);
      });
    }

    if(els.btnGerar){
      els.btnGerar.addEventListener('click',()=>{
        state.tema=els.inpTema.value.trim();
        if(!state.tema && !state.materialTexto){
          alert('Defina um tema ou envie um material.');
          return;
        }
        const topicos=extrairTopicos(state.materialTexto,state.tema,state.dias);
        state.plano=construirPlano(topicos,state.dias,state.tema);
        updateCtx();
        renderPlano();
        setStatus('Plano criado com sucesso!');
      });
    }

    renderPlano();
    updateCtx();
  </script>
</body>
</html>

